import{a as ie,b as ne}from"./chunk-MEBUCGCQ.js";import{c as F,g as B}from"./chunk-VTKZNL4V.js";import{a as U,b as X}from"./chunk-MDRIXYBX.js";import{a as R,b as q,c as z,e as G,f as H,g as $,h as ee}from"./chunk-56Q56IV5.js";import{Ja as oe,Ka as ae,aa as J,b as I,f as L,fa as K,g as V,ga as Q,h as A,ha as Y,i as E,j as W,ka as Z,l as T,m as N,ma as te,n as j,p as D}from"./chunk-EWSGLXCW.js";import{$a as w,Ab as m,Ec as O,Fb as c,Gb as f,Hb as M,Ja as r,Jb as S,Ka as g,bb as l,f as C,gc as P,hb as i,ib as n,ic as k,jb as b,ka as _,nb as y,qb as x,ra as p,sa as u,zb as v}from"./chunk-R7MLKEAJ.js";function le(o,re){o&1&&b(0,"mat-spinner",13)}function me(o,re){o&1&&(i(0,"span"),m(1,"\u767B\u5165"),n())}var Le=(()=>{class o{constructor(a,s,e){this.supabase=a,this.router=s,this.snackBar=e,this.email="",this.password="",this.rememberMe=!0,this.loading=!1}onSubmit(){return C(this,null,function*(){if(!(!this.email||!this.password)){this.loading=!0;try{this.supabase.setRememberMe(this.rememberMe),yield this.supabase.signIn(this.email,this.password);let a=yield this.supabase.isAdmin();this.snackBar.open("\u767B\u5165\u6210\u529F\uFF01","\u95DC\u9589",{duration:3e3}),a?this.router.navigate(["/admin/devices"]):this.router.navigate(["/"])}catch(a){console.error("Login error:",a),this.snackBar.open(a.message||"\u767B\u5165\u5931\u6557\uFF0C\u8ACB\u6AA2\u67E5\u5E33\u865F\u5BC6\u78BC","\u95DC\u9589",{duration:5e3})}finally{this.loading=!1}}})}static{this.\u0275fac=function(s){return new(s||o)(g(O),g(F),g(oe))}}static{this.\u0275cmp=_({type:o,selectors:[["app-login"]],standalone:!0,features:[S],decls:24,vars:9,consts:[["loginForm","ngForm"],[1,"login-container"],[1,"login-card"],["src","assets/images/favicon.png","alt","\u501F\u6A5F\u6A5F",1,"logo"],[1,"subtitle"],[3,"ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","type","email","name","email","required","","email","",3,"ngModelChange","ngModel","disabled"],["matInput","","type","password","name","password","required","","minlength","6",3,"ngModelChange","ngModel","disabled"],["name","rememberMe","color","primary",1,"remember-checkbox",3,"ngModelChange","ngModel","disabled"],["mat-raised-button","","color","primary","type","submit",1,"full-width","login-btn",3,"disabled"],["diameter","20",4,"ngIf"],[4,"ngIf"],["diameter","20"]],template:function(s,e){if(s&1){let d=y();i(0,"div",1)(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title"),b(4,"img",3),m(5," \u767B\u5165 "),n(),i(6,"p",4),m(7,"\u501F\u6A5F\u6A5F - \u8F15\u9B06\u7BA1\u7406\u5718\u968A\u7684\u6E2C\u8A66\u8A2D\u5099"),n()(),i(8,"mat-card-content")(9,"form",5,0),x("ngSubmit",function(){return p(d),u(e.onSubmit())}),i(11,"mat-form-field",6)(12,"mat-label"),m(13,"Email"),n(),i(14,"input",7),M("ngModelChange",function(t){return p(d),f(e.email,t)||(e.email=t),u(t)}),n()(),i(15,"mat-form-field",6)(16,"mat-label"),m(17,"\u5BC6\u78BC"),n(),i(18,"input",8),M("ngModelChange",function(t){return p(d),f(e.password,t)||(e.password=t),u(t)}),n()(),i(19,"mat-checkbox",9),M("ngModelChange",function(t){return p(d),f(e.rememberMe,t)||(e.rememberMe=t),u(t)}),m(20," \u8A18\u4F4F\u767B\u5165\u72C0\u614B "),n(),i(21,"button",10),w(22,le,1,0,"mat-spinner",11)(23,me,2,0,"span",12),n()()()()()}if(s&2){let d=v(10);r(14),c("ngModel",e.email),l("disabled",e.loading),r(4),c("ngModel",e.password),l("disabled",e.loading),r(),c("ngModel",e.rememberMe),l("disabled",e.loading),r(2),l("disabled",e.loading||!d.valid),r(),l("ngIf",e.loading),r(),l("ngIf",!e.loading)}},dependencies:[k,P,D,W,I,L,V,T,j,N,E,A,B,H,R,z,G,q,Q,K,J,X,U,Z,Y,ee,$,te,ne,ie,ae],styles:[".login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at top,#2e3136,#1f2124 55%,#17191c);padding:16px}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:24px}mat-card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:24px}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:24px}.logo[_ngcontent-%COMP%]{width:36px;height:36px}.subtitle[_ngcontent-%COMP%]{margin:8px 0 0;font-size:14px;color:var(--app-text-muted)}.full-width[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]     .login-card .mdc-text-field--outlined{background-color:var(--app-surface-elev)}[_nghost-%COMP%]     .login-card .mdc-text-field__input{color:var(--app-text)!important;caret-color:var(--app-text)}[_nghost-%COMP%]     .login-card .mdc-text-field__input:focus{color:var(--app-text)!important}[_nghost-%COMP%]     .login-card input:-webkit-autofill{-webkit-text-fill-color:var(--app-text);box-shadow:0 0 0 1000px var(--app-surface-elev) inset;transition:background-color 5000s ease-in-out 0s}[_nghost-%COMP%]     .login-card input:-webkit-autofill:focus{-webkit-text-fill-color:var(--app-text);box-shadow:0 0 0 1000px var(--app-surface-elev) inset}.remember-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:16px}.login-btn[_ngcontent-%COMP%]{height:48px;font-size:16px}.login-btn[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block}"]})}}return o})();export{Le as LoginComponent};
