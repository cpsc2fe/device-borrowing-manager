import{c as O,d as F,g as B}from"./chunk-PAKVZ7YK.js";import{a as R,b as q,c as G,e as H,f as J,g as Y,k as Z,l as $,m as tt,n as et,o as it,p as nt,q as ot,r as at}from"./chunk-IULNBF3J.js";import{b as E,ba as K,da as Q,ea as U,f as L,fa as X,g as V,h as A,i as N,j as T,l as D,m as W,n as j,o as z}from"./chunk-O6CXBG2O.js";import{$a as x,Ab as o,Ec as I,Fb as f,Gb as M,Hb as h,Ja as m,Jb as k,Ka as g,bb as s,f as C,gc as P,hb as e,ib as i,ic as S,jb as u,ka as b,nb as w,qb as v,ra as p,sa as c,zb as y}from"./chunk-RS4Y4S6U.js";function lt(n,rt){n&1&&u(0,"mat-spinner",14)}function mt(n,rt){n&1&&(e(0,"span"),o(1,"\u767B\u5165"),i())}var It=(()=>{class n{constructor(a,l,t){this.supabase=a,this.router=l,this.snackBar=t,this.email="",this.password="",this.loading=!1}onSubmit(){return C(this,null,function*(){if(!(!this.email||!this.password)){this.loading=!0;try{if(yield this.supabase.signIn(this.email,this.password),!(yield this.supabase.isAdmin())){yield this.supabase.signOut(),this.snackBar.open("\u6B64\u5E33\u865F\u6C92\u6709\u7BA1\u7406\u54E1\u6B0A\u9650","\u95DC\u9589",{duration:5e3});return}this.snackBar.open("\u767B\u5165\u6210\u529F\uFF01","\u95DC\u9589",{duration:3e3}),this.router.navigate(["/admin/devices"])}catch(a){console.error("Login error:",a),this.snackBar.open(a.message||"\u767B\u5165\u5931\u6557\uFF0C\u8ACB\u6AA2\u67E5\u5E33\u865F\u5BC6\u78BC","\u95DC\u9589",{duration:5e3})}finally{this.loading=!1}}})}static{this.\u0275fac=function(l){return new(l||n)(g(I),g(O),g(ot))}}static{this.\u0275cmp=b({type:n,selectors:[["app-login"]],standalone:!0,features:[k],decls:27,vars:7,consts:[["loginForm","ngForm"],[1,"login-container"],[1,"login-card"],["src","assets/images/favicon.png","alt","\u501F\u6A5F\u6A5F",1,"logo"],[1,"subtitle"],[3,"ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","type","email","name","email","required","","email","",3,"ngModelChange","ngModel","disabled"],["matInput","","type","password","name","password","required","","minlength","6",3,"ngModelChange","ngModel","disabled"],["mat-raised-button","","color","primary","type","submit",1,"full-width","login-btn",3,"disabled"],["diameter","20",4,"ngIf"],[4,"ngIf"],[1,"back-link"],["routerLink","/"],["diameter","20"]],template:function(l,t){if(l&1){let d=w();e(0,"div",1)(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title"),u(4,"img",3),o(5," \u7BA1\u7406\u54E1\u767B\u5165 "),i(),e(6,"p",4),o(7,"\u501F\u6A5F\u6A5F"),i()(),e(8,"mat-card-content")(9,"form",5,0),v("ngSubmit",function(){return p(d),c(t.onSubmit())}),e(11,"mat-form-field",6)(12,"mat-label"),o(13,"Email"),i(),e(14,"input",7),h("ngModelChange",function(r){return p(d),M(t.email,r)||(t.email=r),c(r)}),i()(),e(15,"mat-form-field",6)(16,"mat-label"),o(17,"\u5BC6\u78BC"),i(),e(18,"input",8),h("ngModelChange",function(r){return p(d),M(t.password,r)||(t.password=r),c(r)}),i()(),e(19,"button",9),x(20,lt,1,0,"mat-spinner",10)(21,mt,2,0,"span",11),i()(),e(22,"div",12)(23,"a",13)(24,"mat-icon"),o(25,"arrow_back"),i(),o(26," \u8FD4\u56DE\u8A2D\u5099\u5217\u8868 "),i()()()()()}if(l&2){let d=y(10);m(14),f("ngModel",t.email),s("disabled",t.loading),m(4),f("ngModel",t.password),s("disabled",t.loading),m(),s("disabled",t.loading||!d.valid),m(),s("ngIf",t.loading),m(),s("ngIf",!t.loading)}},dependencies:[S,P,z,T,E,L,V,D,j,W,N,A,B,F,J,R,G,H,q,$,Z,Y,et,tt,Q,K,nt,it,X,U,at],styles:[".login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at top,#2e3136,#1f2124 55%,#17191c);padding:16px}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:24px}mat-card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:24px}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:24px}.logo[_ngcontent-%COMP%]{width:36px;height:36px}.subtitle[_ngcontent-%COMP%]{margin:8px 0 0;font-size:14px;color:var(--app-text-muted)}.full-width[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]     .login-card .mdc-text-field--outlined{background-color:var(--app-surface-elev)}[_nghost-%COMP%]     .login-card .mdc-text-field__input{color:var(--app-text)!important;caret-color:var(--app-text)}[_nghost-%COMP%]     .login-card .mdc-text-field__input:focus{color:var(--app-text)!important}[_nghost-%COMP%]     .login-card input:-webkit-autofill{-webkit-text-fill-color:var(--app-text);box-shadow:0 0 0 1000px var(--app-surface-elev) inset;transition:background-color 5000s ease-in-out 0s}[_nghost-%COMP%]     .login-card input:-webkit-autofill:focus{-webkit-text-fill-color:var(--app-text);box-shadow:0 0 0 1000px var(--app-surface-elev) inset}.login-btn[_ngcontent-%COMP%]{height:48px;font-size:16px;margin-bottom:16px}.login-btn[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block}.back-link[_ngcontent-%COMP%]{text-align:center}.back-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;color:var(--app-accent);text-decoration:none}.back-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.back-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}"]})}}return n})();export{It as LoginComponent};
