import{a as ne,b as oe}from"./chunk-MEBUCGCQ.js";import{a as F,c as B,g as O}from"./chunk-VTKZNL4V.js";import{a as X,b as Y}from"./chunk-MDRIXYBX.js";import{a as D,b as z,c as U,e as G,f as H,g as ee,h as te}from"./chunk-56Q56IV5.js";import{Ja as ae,Ka as re,aa as J,b as L,f as V,fa as K,g as A,ga as Q,h as E,ha as Z,i as W,j as T,ka as $,l as N,m as j,ma as ie,n as R,p as q}from"./chunk-EWSGLXCW.js";import{$a as w,Ab as d,Ec as I,Fb as c,Gb as f,Hb as M,Ja as m,Jb as S,Ka as g,bb as s,f as C,gc as P,hb as i,ib as n,ic as k,jb as b,ka as _,nb as y,qb as x,ra as p,sa as u,zb as v}from"./chunk-R7MLKEAJ.js";function me(a,le){a&1&&b(0,"mat-spinner",13)}function se(a,le){a&1&&(i(0,"span"),d(1,"\u767B\u5165"),n())}var Ve=(()=>{class a{constructor(r,o,e,l){this.supabase=r,this.router=o,this.route=e,this.snackBar=l,this.email="",this.password="",this.rememberMe=!0,this.loading=!1}onSubmit(){return C(this,null,function*(){if(!(!this.email||!this.password)){this.loading=!0;try{this.supabase.setRememberMe(this.rememberMe),yield this.supabase.signIn(this.email,this.password);let r=yield this.supabase.isAdmin();this.snackBar.open("\u767B\u5165\u6210\u529F\uFF01","\u95DC\u9589",{duration:3e3});let o=this.route.snapshot.queryParams.returnUrl;o?this.router.navigateByUrl(o):r?this.router.navigate(["/admin/devices"]):this.router.navigate(["/"])}catch(r){console.error("Login error:",r),this.snackBar.open(r.message||"\u767B\u5165\u5931\u6557\uFF0C\u8ACB\u6AA2\u67E5\u5E33\u865F\u5BC6\u78BC","\u95DC\u9589",{duration:5e3})}finally{this.loading=!1}}})}static{this.\u0275fac=function(o){return new(o||a)(g(I),g(B),g(F),g(ae))}}static{this.\u0275cmp=_({type:a,selectors:[["app-login"]],standalone:!0,features:[S],decls:24,vars:9,consts:[["loginForm","ngForm"],[1,"login-container"],[1,"login-card"],["src","assets/images/favicon.png","alt","\u501F\u6A5F\u6A5F",1,"logo"],[1,"subtitle"],[3,"ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","type","email","name","email","required","","email","",3,"ngModelChange","ngModel","disabled"],["matInput","","type","password","name","password","required","","minlength","6",3,"ngModelChange","ngModel","disabled"],["name","rememberMe","color","primary",1,"remember-checkbox",3,"ngModelChange","ngModel","disabled"],["mat-raised-button","","color","primary","type","submit",1,"full-width","login-btn",3,"disabled"],["diameter","20",4,"ngIf"],[4,"ngIf"],["diameter","20"]],template:function(o,e){if(o&1){let l=y();i(0,"div",1)(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title"),b(4,"img",3),d(5," \u767B\u5165 "),n(),i(6,"p",4),d(7,"\u501F\u6A5F\u6A5F - \u8F15\u9B06\u7BA1\u7406\u5718\u968A\u7684\u6E2C\u8A66\u8A2D\u5099"),n()(),i(8,"mat-card-content")(9,"form",5,0),x("ngSubmit",function(){return p(l),u(e.onSubmit())}),i(11,"mat-form-field",6)(12,"mat-label"),d(13,"Email"),n(),i(14,"input",7),M("ngModelChange",function(t){return p(l),f(e.email,t)||(e.email=t),u(t)}),n()(),i(15,"mat-form-field",6)(16,"mat-label"),d(17,"\u5BC6\u78BC"),n(),i(18,"input",8),M("ngModelChange",function(t){return p(l),f(e.password,t)||(e.password=t),u(t)}),n()(),i(19,"mat-checkbox",9),M("ngModelChange",function(t){return p(l),f(e.rememberMe,t)||(e.rememberMe=t),u(t)}),d(20," \u8A18\u4F4F\u767B\u5165\u72C0\u614B "),n(),i(21,"button",10),w(22,me,1,0,"mat-spinner",11)(23,se,2,0,"span",12),n()()()()()}if(o&2){let l=v(10);m(14),c("ngModel",e.email),s("disabled",e.loading),m(4),c("ngModel",e.password),s("disabled",e.loading),m(),c("ngModel",e.rememberMe),s("disabled",e.loading),m(2),s("disabled",e.loading||!l.valid),m(),s("ngIf",e.loading),m(),s("ngIf",!e.loading)}},dependencies:[k,P,q,T,L,V,A,N,R,j,W,E,O,H,D,U,G,z,Q,K,J,Y,X,$,Z,te,ee,ie,oe,ne,re],styles:[".login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at top,#2e3136,#1f2124 55%,#17191c);padding:16px}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:24px}mat-card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:24px}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:24px}.logo[_ngcontent-%COMP%]{width:36px;height:36px}.subtitle[_ngcontent-%COMP%]{margin:8px 0 0;font-size:14px;color:var(--app-text-muted)}.full-width[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]     .login-card .mdc-text-field--outlined{background-color:var(--app-surface-elev)}[_nghost-%COMP%]     .login-card .mdc-text-field__input{color:var(--app-text)!important;caret-color:var(--app-text)}[_nghost-%COMP%]     .login-card .mdc-text-field__input:focus{color:var(--app-text)!important}[_nghost-%COMP%]     .login-card input:-webkit-autofill{-webkit-text-fill-color:var(--app-text);box-shadow:0 0 0 1000px var(--app-surface-elev) inset;transition:background-color 5000s ease-in-out 0s}[_nghost-%COMP%]     .login-card input:-webkit-autofill:focus{-webkit-text-fill-color:var(--app-text);box-shadow:0 0 0 1000px var(--app-surface-elev) inset}.remember-checkbox[_ngcontent-%COMP%]{display:block;margin-bottom:16px}.login-btn[_ngcontent-%COMP%]{height:48px;font-size:16px}.login-btn[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block}"]})}}return a})();export{Ve as LoginComponent};
