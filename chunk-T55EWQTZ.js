import{Ec as l,aa as c,f as r,fa as n}from"./chunk-R7MLKEAJ.js";var h=(()=>{class i{constructor(e){this.supabase=e}getDevices(){return r(this,null,function*(){let{data:e,error:t}=yield this.supabase.client.from("devices_with_borrower").select("*").order("name");if(t)throw t;return e})}getDevice(e){return r(this,null,function*(){let{data:t,error:a}=yield this.supabase.client.from("devices_with_borrower").select("*").eq("id",e).single();if(a)throw a;return t})}getDeviceForAdmin(e){return r(this,null,function*(){let{data:t,error:a}=yield this.supabase.client.from("devices").select("*").eq("id",e).single();if(a)throw a;return t})}createDevice(e){return r(this,null,function*(){let{data:t,error:a}=yield this.supabase.client.from("devices").insert(e).select().single();if(a)throw a;return t})}updateDevice(e,t){return r(this,null,function*(){let{data:a,error:s}=yield this.supabase.client.from("devices").update(t).eq("id",e).select().single();if(s)throw s;return a})}deleteDevice(e){return r(this,null,function*(){let{error:t}=yield this.supabase.client.from("devices").delete().eq("id",e);if(t)throw t})}uploadImage(e){return r(this,null,function*(){let t=e.name.split(".").pop(),s=`devices/${`${Date.now()}.${t}`}`,{error:o}=yield this.supabase.client.storage.from("device-images").upload(s,e);if(o)throw o;let{data:d}=this.supabase.client.storage.from("device-images").getPublicUrl(s);return d.publicUrl})}deleteImage(e){return r(this,null,function*(){let t=e.split("/device-images/")[1];if(t){let{error:a}=yield this.supabase.client.storage.from("device-images").remove([t]);if(a)throw a}})}getStats(){return r(this,null,function*(){let{data:e,error:t}=yield this.supabase.client.from("devices").select("status");if(t)throw t;return{total:e.length,available:e.filter(s=>s.status==="available").length,borrowed:e.filter(s=>s.status==="borrowed").length,maintenance:e.filter(s=>s.status==="maintenance").length}})}static{this.\u0275fac=function(t){return new(t||i)(n(l))}}static{this.\u0275prov=c({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{h as a};
